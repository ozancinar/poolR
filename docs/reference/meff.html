<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate the Effective Number of Tests — meff • poolr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate the Effective Number of Tests — meff" />
<meta property="og:description" content="Estimate the effective number of tests." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poolr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.28</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the Effective Number of Tests</h1>
    
    <div class="hidden name"><code>meff.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the effective number of tests.</p>
    </div>

    <pre class="usage"><span class='fu'>meff</span>(<span class='no'>R</span>, <span class='no'>eigen</span>, <span class='no'>method</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>R</th>
      <td><p>a \(k \times k\) symmetric matrix that reflects the correlation structure among the tests.</p></td>
    </tr>
    <tr>
      <th>eigen</th>
      <td><p>optional vector to directly supply the eigenvalues to the function (instead of computing them from the matrix given via <code>R</code>).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character string to specify the method to be used to estimate the effective number of tests (either <code>"nyholt"</code>, <code>"liji"</code>, <code>"gao"</code>, or <code>"galwey"</code>. See &#8216;Details&#8217;.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>The function estimates the effective number of tests based on one of four different methods. All methods work by extracting the eigenvalues from the \(R\) matrix supplied via the <code>R</code> argument (or from the eigenvalues directly passed via the <code>eigen</code> argument). Letting \(\lambda_i\) denote the \(i\)th eigenvalue of this matrix (with \(i = 1, \ldots, k\)), the effective number of tests (\(m\)) is estimated as follows.</p>
<p><b>Method by Nyholt (2004)</b></p>
<p>$$m = 1 + (k - 1) \left(1 - \frac{\mbox{Var}(\lambda)}{k}\right)$$ where \(\mbox{Var}(\lambda)\) is the observed sample variance of the \(k\) eigenvalues.</p>
<p><b>Method by Li &amp; Ji (2005)</b></p>
<p>$$m = \sum_{i = 1}^k f(|\lambda_i|)$$ where \(f(x) = I(x \geq 1) + (x - \lfloor x \rfloor)\) and \(\lfloor . \rfloor\) is the floor function.</p>
<p><b>Method by Gao et al. (2008)</b></p>
<p>$$m = \min(x) \; \mbox{such that} \; \frac{\sum_{i = 1}^x \lambda_{(i)}}{\sum_{i = 1}^k \lambda_{(i)}} &gt; C$$ where \(\lambda_{(1)}, \lambda_{(2)}, \ldots, \lambda_{(k)}\) are the sorted eigenvalues in decreasing order and \(C\) is a pre-defined parameter which is set to 0.995 by default.</p>
<p><b>Method by Galwey (2009)</b></p>
<p>$$m = \frac{\left(\sum_{i = 1}^k \sqrt{\lambda_i'}\right)^2}{\sum_{i = 1}^k \lambda_i'}$$ where \(\lambda_i' = 0\) if \(\lambda_i &lt; 0\) and \(\lambda_i\) otherwise.</p>
<p><b>Note:</b> For all methods that can yield a non-integer estimate (all but the method by Gao et al., 2008), the resulting estimate \(m\) is rounded down to the nearest integer.</p>
<p><b>Specifying the R Matrix</b></p>
<p>The \(R\) matrix should reflect the correlation structure among the tests. There is no general solution on how such a correlation matrix should be constructed, as this depends on the type of test and the sidedness of these tests. For example, we can use the correlations among related but changing elements across the analyses/tests, or a function thereof, as a proxy for the correlation structure. For example, when conducting \(k\) analyses with the same dependent variable and \(k\) different independent variables, the correlations among the independent variables could serve as such a proxy. Analogously, if analyses are conducted for \(k\) dependent variables with the same set of independent variables, the correlations among the dependent variables could be used instead.</p>
<p>If the tests of interest have test statistics that can be assumed to follow a multivariate normal distribution and a matrix is available that reflects the correlations among the test statistics (which might be approximated by the correlations among the interchanging independent or dependent variables), then the <code><a href='mvnconv.html'>mvnconv</a></code> function can be used to convert this correlation matrix into the correlations among the (one- or two-sided) \(p\)-values, which in turn can then be passed to the <code>R</code> argument. See &#8216;Examples&#8217;.</p>
<p><b>Not Positive Semi-Definite R</b></p>
<p>Depending on the way \(R\) is constructed, it may happen that this matrix is not positive semi-definite, leading to negative eigenvalues. The methods given above can all still be carried out in this case. However, another possibility is to handle such a case by using an algorithm that finds the nearest positive (semi-)definite matrix (e.g., Higham 2002) before passing this matrix to the function (see <code><a href='https://rdrr.io/pkg/Matrix/man/nearPD.html'>nearPD</a></code> from the <span class="pkg">Matrix</span> package for a corresponding implementation).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A scalar giving the estimate of the effective number of tests.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>For <code>method = "gao"</code>, <code>C = 0.995</code> by default, but a different value of <code>C</code> can be passed to the function via <code>...</code> (e.g., <code>meff(R, method = "gao", C = 0.95)</code>).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gao, X., Starmer, J., &amp; Martin, E. R. (2008). A multiple testing correction method for genetic association studies using correlated single nucleotide polymorphisms. <em>Genetic Epidemiology, 32</em>(4), 361-369.</p>
<p>Galwey, N. W. (2009). A new measure of the effective number of tests, a practical tool for comparing families of non-independent significance tests. <em>Genetic Epidemiology, 33</em>(7), 559-568.</p>
<p>Higham, N. J. (2002). Computing the nearest correlation matrix: A problem from finance. <em>IMA Journal of Numerical Analysis, 22</em>(3), 329-343.</p>
<p>Li, J., &amp; Ji, L. (2005). Adjusting multiple testing in multilocus analyses using the eigenvalues of a correlation matrix. <em>Heredity, 95</em>(3), 221-227.</p>
<p>Nyholt, D. R. (2004). A simple correction for multiple testing for single-nucleotide polymorphisms in linkage disequilibrium with each other. <em>American Journal of Human Genetics, 74</em>(4), 765-769.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># copy LD correlation matrix into r (see help(grid2ip) for details on these data)</span>
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='no'>grid2ip.ld</span>

<span class='co'># estimate the effective number of tests based on the LD correlation matrix</span>
<span class='fu'>meff</span>(<span class='no'>r</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"nyholt"</span>)</div><div class='output co'>#&gt; [1] 20</div><div class='input'><span class='fu'>meff</span>(<span class='no'>r</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"liji"</span>)</div><div class='output co'>#&gt; [1] 15</div><div class='input'><span class='fu'>meff</span>(<span class='no'>r</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"gao"</span>)</div><div class='output co'>#&gt; [1] 18</div><div class='input'><span class='fu'>meff</span>(<span class='no'>r</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"galwey"</span>)</div><div class='output co'>#&gt; [1] 13</div><div class='input'>
<span class='co'># use mvnconv() to convert the LD correlation matrix into a matrix with the</span>
<span class='co'># correlations among the (two-sided) p-values assuming that the test</span>
<span class='co'># statistics follow a multivariate normal distribution with correlation</span>
<span class='co'># matrix r (note: 'side = 2' by default in mvnconv())</span>
<span class='fu'><a href='mvnconv.html'>mvnconv</a></span>(<span class='no'>r</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>cov2cor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)[<span class='fl'>1</span>:<span class='fl'>5</span>,<span class='fl'>1</span>:<span class='fl'>5</span>] <span class='co'># show only rows/columns 1-5</span></div><div class='output co'>#&gt;            [,1]       [,2]        [,3]        [,4]        [,5]
#&gt; [1,] 1.00000000 0.02160864 0.021608643 0.010804322 0.097238896
#&gt; [2,] 0.02160864 1.00000000 0.013205282 0.000000000 0.042016807
#&gt; [3,] 0.02160864 0.01320528 1.000000000 0.006002401 0.006002401
#&gt; [4,] 0.01080432 0.00000000 0.006002401 1.000000000 0.000000000
#&gt; [5,] 0.09723890 0.04201681 0.006002401 0.000000000 1.000000000</div><div class='input'>
<span class='co'># use this matrix instead for estimating the effective number of tests</span>
<span class='fu'>meff</span>(<span class='fu'><a href='mvnconv.html'>mvnconv</a></span>(<span class='no'>r</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>cov2cor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"nyholt"</span>)</div><div class='output co'>#&gt; [1] 22</div><div class='input'><span class='fu'>meff</span>(<span class='fu'><a href='mvnconv.html'>mvnconv</a></span>(<span class='no'>r</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>cov2cor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"liji"</span>)</div><div class='output co'>#&gt; [1] 21</div><div class='input'><span class='fu'>meff</span>(<span class='fu'><a href='mvnconv.html'>mvnconv</a></span>(<span class='no'>r</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>cov2cor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"gao"</span>)</div><div class='output co'>#&gt; [1] 23</div><div class='input'><span class='fu'>meff</span>(<span class='fu'><a href='mvnconv.html'>mvnconv</a></span>(<span class='no'>r</span>, <span class='kw'>target</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='kw'>cov2cor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"galwey"</span>)</div><div class='output co'>#&gt; [1] 20</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Ozan Cinar <a href='mailto:ozancinar86@gmail.com'>ozancinar86@gmail.com</a> <br />
   Wolfgang Viechtbauer <a href='mailto:wvb@wvbauer.com'>wvb@wvbauer.com</a> <br /></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ozan Cinar, Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


